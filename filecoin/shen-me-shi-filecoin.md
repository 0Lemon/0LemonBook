---
description: FileCoin网络是如何运行的？
---

# 什么是FileCoin?

{% hint style="info" %}
转自CSDN-[星际空间ipfs](https://blog.csdn.net/ispacexio/article/details/112534343)，博主原创文章，遵循[ CC 4.0 BY-SA ](http://creativecommons.org/licenses/by-sa/4.0/)版权协议。
{% endhint %}

Filecoin是《协议实验室》旗下基于区块链项目，是IPFS分布式存储协议的激励层，具有内置的经济激励机制，可确保随着时间的推移分布式节点能够可靠地存储文件。

在Filecoin中，用户付费将其文件存储在存储矿工上。存储矿工是负责存储文件并证明其已随时间正确存储文件的计算机。任何想要存储其文件或希望因存储其他用户的文件而获得报酬的人都可以加入Filecoin。可用存储空间以及该存储空间的价格不受任何一家公司的控制。相反，Filecoin促进了开放市场的存储和检索任何人都可以参与的文件。

Filecoin包括区块链和本机加密货币（FIL）。存储矿工通过存储文件赚取FIL单位。Filecoin的区块链记录了要发送和接收FIL的交易，以及来自存储矿工的证明，证明他们正确存储了文件。

![](../.gitbook/assets/image%20%2886%29.png)

## 对于用户

Filecoin使用户能够以极具竞争力的价格存储其文件，并验证其文件是否正确存储。用户可以通过选择最适合其存储需求的矿机，在成本，冗余性和速度之间选择自己喜欢的折衷方案。实现Filecoin的应用程序可以与网络上的任何矿工协商存储。与集中式存储系统不同，不需要为每个提供程序实现不同的API。用户可以随时通过查看Filecoin区块链上的证据来验证其文件是否正确存储。

![](../.gitbook/assets/image%20%2891%29.png)

## 对于存储提供商（矿工）

Filecoin使存储提供商可以在公开市场上出售其存储。存储提供商是运行矿工并以此获得Filecoin令牌的人员和组织。矿工可以是任何具有备用磁盘空间的互联网连接计算机，也可以是专门为Filecoin构建的具有大量存储的专用系统。Filecoin的区块链奖励矿工，他们为互联网贡献了有用的存储空间，而不是为了完成浪费的工作量证明计算。

![](../.gitbook/assets/image%20%2845%29.png)

一旦存储提供商实施了Filecoin协议，他们就可以访问Filecoin用户的整个市场。提供商不需要设计自己的存储API或自己宣传其产品，因为这是由Filecoin的协议和网络处理的。Filecoin通过消除进入壁垒，实现了独立存储提供商蓬勃发展的分散式生态系统。

## Filecoin和Web3.0

Web3是软件开发领域的一项运动，正在将集中式应用程序转变为分散式协议。构建在web3架构上的应用程序不必具有单一控制点，而是可以消除中间人，从而降低大公司进行审查的风险，并使服务容易受到拒绝服务攻击的威胁。Web3是一种不需要信任的基础结构，它允许用户拥有所有权并收回对其数据的控制权。Web3.0本质上是通过允许在同级之间共享文件来允许Filecoin存在的。

![](../.gitbook/assets/image%20%28127%29.png)

## 网络

Filecoin网络是由Filecoin对等方以不同方式参与而形成的分布式对等网络。对等点通过安全通道进行通信，他们使用这些安全通道将信息分发到网络，在彼此之间传输数据并发现其他对等点，从而保持了连接良好的群体，即使有成千上万的信息，块和消息等信息也会迅速流动。同行参加。

## Filecoin节点

**Filecoin节点**或**Filecoin客户端**是同步Filecoin区块链并验证每个块中消息的对等点，一旦应用，它们就会提供全局状态。节点可以管理Filecoin钱包并在其上接收FIL。

Filecoin节点还可以通过广播将不同类型的消息发布到网络。例如，客户端可以发布一条消息，以将FIL从一个地址发送到另一个地址。节点可以向Filecoin矿工提议存储和检索交易，并在执行时为其支付费用。

![](../.gitbook/assets/image%20%28108%29.png)

运行Filecoin节点是一个低级任务，通常意味着保持程序24/7运行。有几种Filecoin Node实施方案正在开发中，其中Lotus是最先进的。

## Filecoin矿工

矿工通过执行不同类型的交易并将新的区块附加到链中（每30秒）来向网络提供服务，为此他们收集FIL奖励。

运行Filecoin矿工是一项技术含量很高的任务，具有强大的硬件要求，需要完成必要的证明。迄今为止，Lotus Miner是Filecoin矿工的最先进实现。

## 交易

Filecoin有两种主要的交易类型：存储交易和检索交易。

存储交易是客户端与存储矿工之间的协议，用于在网络中存储一些数据。一旦交易开始，矿工接收到数据打包存储，并反复向区块链证明持续按照协议存储数据，以便获得Fil奖励。否则，矿工将被罚没并失去FIL。

检索交易是客户端与检索矿工（可能是也可能不是存储矿工）之间的协议，以提取存储在网络中的数据（希望以一种快速，可靠的方式）。与存储交易不同，这些交易是通过使用支付渠道以增量方式为接收到的数据付款的链下交易来实现的。

## 证明

如上所述，存储矿工必须证明他们按照交易协议存储数据。这意味着：

1，他们必须存储客户端提交的所有数据

2，他们必须在交易的整个生命周期内进行存储

矿工使用复制证明（PoRep）证明他们已接收到所有数据，并使用其物理存储以该矿工唯一的方式对其进行了编码，而其他矿工无法复制（因此，两笔交易需要相同的交易，数据最终无法重新使用同一磁盘）。交易开始且密封操作完成时提供此证明。

一旦达成交易并在其整个生命周期内，矿工将使用时空证明（PoSt）证明其仍在存储与交易相关的数据。对于PoSt，随机矿工需要证明他们存储的数据的随机部分仍然存在。

Filecoin客户和其他矿工不断验证每个区块中包含的证据是否有效，从而提供必要的安全性并惩罚不履行其交易的矿工。

## Gas费

通过在链中包括交易或证明执行消息会消耗网络上的计算和存储资源，Gas是消息消耗的资源的量度。消息消耗的Gas直接影响发件人必须支付的费用，矿工将其包括在新块中。

历史上在其他区块链中，矿工以本币为单位指定GasFee，然后根据消息消耗的天然气量向生产矿工的区块支付优先费用。Filecoin的工作原理类似，只是要烧掉一定数量的费用（发送到不可恢复的地址）以补偿网络的资源消耗，因为所有节点都需要验证消息。这个想法是基于以太坊的EIP1559 。

Filecoin网络中消耗的费用金额是由动态的 BaseFee给出的，该费用会根据网络拥塞参数（块大小）自动进行调整。当前值可以从块浏览器之一获得，也可以通过检查当前区块来获得。

![](../.gitbook/assets/image%20%28123%29.png)

此外，每条消息都附有许多与气体有关的参数，这些参数确定了矿工获得的奖励数量。以下是术语和概念的概述：

* **GasUsage：**消息执行实际消耗的气体量。当前协议不知道一条消息在执行之前将确切消耗多少气体，但是可以对其进行估计。GasUsage以Gas单位计量。 
* **BaseFee：**执行每条消息所消耗的每单位燃气消耗的FIL数量。它以attoFIL / Gas为单位计量。 
* **GasLimit：**消息发送者可以消耗，估计和指定的消息执行量的限制。它以Gas为单位测量。块中包含的所有消息的GasLimit的总和不得超过BlockGasLimit。如果消息用尽Gas，则消息将无法执行，并且执行的任何效果都将被还原。 
* **GasFeeCap：**发送方愿意为每个GasUnit支付的最大令牌金额，以将消息包含在块中。它以attoFIL / Gas为单位测量。发送消息时，消息发送者必须具有GasFeeCap \* GasLimit的最小余额，即使并非所有余额都将被消耗掉。GasFeeCap可以防止BaseFee出现较大的意外波动。 
* **GasPremium：**支付给块状生产矿工的优先费，这是由GasFeeCap限制，BaseFee具有更高的优先级。它以attoFIL / Gas为单位进行测量，并且可以低至1 attoFIL / Gas。
*  **高估燃烧：**当GasLimit和GasUsage之间的差异较大时，燃烧的额外气体量会增加。

发件人的一条消息的总费用为：

* **GasUsage**  _**BaseFee FIL（已燃烧）+**_ 
* _**GasLimit**_  **GasPremium FIL（矿工的奖励）+**
*  **OverEstimationBurn \* BaseFee FIL**

 一个重要的细节是，无论使用哪种GasFeeCap，一条消息将始终支付燃烧费。因此，低GasFeeCap可能导致减少的GasPremium甚至负数！在这种情况下，包含消息的矿工将不得不自掏腰包支付所需的金额，这意味着他们不太可能在新区块中包含此类消息。

Filecoin实现可以选择其矿工如何选择要包含在新区块中的消息的试探法，但是他们通常会尝试最大化矿工的回报。

## 公开市场

在Filecoin中，文件存储和检索交易是在公开市场上协商的。任何人都无需许可即可加入Filecoin网络。运行矿机仅需要Internet连接和备用磁盘空间。通过降低准入门槛，Filecoin可以实现许多独立存储提供商蓬勃发展的生态系统。

![](../.gitbook/assets/image%20%2830%29.png)

## 有竞争力的价格

存储和检索的价格由供求关系确定，而不是由企业定价部门确定。Filecoin以极具竞争力的价格提供可靠的存储。矿工的竞争基于其存储，可靠性和速度，而不是通过营销或锁定用户来进行。

## 可靠的存储

由于存储是付费的，因此Filecoin提供了可行的经济理由，使文件随着时间的推移保持可用状态。文件存储在可靠且与互联网连接良好的计算机上。

## 自我修复

Filecoin网络不断验证文件是否正确存储。Filecoin区块链具有内置的自我修复流程，可在其中检测出故障的矿工，并将其文件重新分发给可靠的矿工。

## 可验证的痕迹

在自我修复的过程中，Filecoin会生成可验证的跟踪，表明随着时间的推移文件已正确存储。客户端可以有效地扫描这些跟踪，以确认其文件已正确存储，即使客户端当时处于脱机状态。任何观察者都可以检查任何矿工的往绩记录，并会通知该矿工过去是否有过故障或离线。

## 可验证的矿工可靠性

在Filecoin中，存储提供商通过其在区块链上发布的跟踪记录来证明其可靠性，而不是通过提供商自己发布的营销声明来证明其可靠性。用户不需要依赖状态页面或来自存储提供商的自我报告的统计信息。

## 权衡选择

用户可以在成本，冗余和速度之间进行权衡取舍。用户不仅限于提供商提供的一组数据中心，还可以选择将其文件存储在任何参与Filecoin的矿工上。

## 放置空存储使用

Filecoin会放置磁盘空间，否则将无法使用。激励矿工加入Filecoin是因为他们的参与获得报酬，这与其他没有经济诱因的分布式网络不同。Filecoin还使加入变得容易，因为矿工可以自我管理其存储，无需人工监督即可获得Filecoin代币。

## 抗审查性

Filecoin拒绝审查，因为任何人不能强迫任何存储提供者删除文件或保留服务。网络由许多不同的人和组织运行的许多不同的计算机组成。网络会注意到有缺陷或恶意的行为者，并会自动将其删除。

## 有用的区块链

在Filecoin中，矿工因提供存储而不是执行浪费的计算而获得奖励。Filecoin使用文件复制证明和随时间的存储证明来保护其区块链。它不像其他区块链那样依赖耗能的工作量证明计划。激励矿工聚集硬盘并通过存储文件来使用它们。Filecoin不会仅出于挖矿的目的来激励显卡或者CPU堆积。

![](../.gitbook/assets/image%20%2889%29.png)

## 为其他区块链提供存储

Filecoin的区块链旨在存储大文件，而其他区块链通常只能存储少量数据，非常昂贵。Filecoin可以为其他区块链提供存储，从而允许它们存储大文件。将来，将在Filecoin中添加机制，使Filecoin的区块链能够与其他区块链上的交易进行互操作。

## 内容寻址

文件是由文件中包含的数据而不是诸如URL之类的易碎标识符来引用的。无论文件在何处托管或由谁托管，文件始终可用。当文件变得流行时，可以通过大量计算机来快速分发文件，而不必依赖中央计算机，因为中央计算机可能会因网络流量而超载。

当多个用户存储同一个文件（并选择不加密不公开文件）时，每个想要下载文件的人都会从Filecoin中受益，从而保持文件可用。无论从何处下载文件，下载者都可以验证他们已收到正确的文件，并且该文件是完整的。

## 内容分发网络

检索式矿工是与许多要下载文件的用户具有良好网络连接的计算机。通过获取流行文件并将其分发给附近的用户，检索矿工将因使网络流量顺畅流动和文件快速下载而获得奖励。

### 单一协议

实现Filecoin的应用程序可以使用相同的协议将其数据存储在任何矿机上，不用为每个提供程序实现的不同API。希望支持多个不同提供商的应用程序不限于其所有提供商都支持的最低公分母集。

### 没有锁定

迁移到其他存储提供商变得更加容易，因为它们都提供相同的服务和API。用户没有被锁定在提供程序中，因为他们依赖提供程序的特定功能。此外，文件具有内容寻址功能，使文件可以在矿工之间直接传输，而无需用户下载和重新上传文件。

传统的云存储提供商通过降低存储文件的成本来锁定用户，但重新获取文件的成本却很高。Filecoin通过促进检索市场来避免这种情况，在该市场中，矿工竞相以尽可能低的价格尽可能快地向用户提供其文件。

## 开源代码

同时运行客户端和存储提供程序的代码是开源的，存储提供商不必开发自己的软件来管理其基础架构，每个人都将从Filecoin代码的改进中受益。

![](../.gitbook/assets/image%20%2868%29.png)

## 活跃社区

Filecoin拥有活跃的贡献者社区，可以回答问题并帮助新手入门。用户，开发人员和存储提供者之间会打开一个对话框。如果需要帮助，可以联系设计或构建相关系统的人员。访问Filecoin的聊天和论坛。

